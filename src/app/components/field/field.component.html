<div [ngSwitch]="field.type" [formGroup]="form">
  <ng-container *ngSwitchCase="'text'">
    <mat-form-field class="w-100" appearance="fill" [hideRequiredMarker]="true">
      <mat-label>{{ field.placeholder || field.label }}</mat-label>
      <input
        matInput
        [placeholder]="field.placeholder || ''"
        [formControlName]="field.name"
        [autofocus]="!!fieldAttributes?.autofocus"
        [minlength]="fieldAttributes?.minlength ?? 0"
        [maxlength]="fieldAttributes?.maxlength ?? 999"
        [readonly]="!!fieldAttributes?.readonly"
        [pattern]="fieldAttributes?.pattern ?? ''"
      />
      <mat-spinner
        class="loading"
        [diameter]="30"
        matSuffix
        *ngIf="!!fieldAttributes?.isLoading"
      ></mat-spinner>
      <mat-error *ngIf="form.get(field.name)?.errors" class="me-2">{{
        showError(form.get(field.name)?.errors)
      }}</mat-error>
    </mat-form-field>
  </ng-container>

  <ng-container *ngSwitchCase="'email'">
    <mat-form-field class="w-100" appearance="fill" [hideRequiredMarker]="true">
      <mat-label>{{ field.placeholder || field.label }}</mat-label>
      <input
        matInput
        type="email"
        [formControlName]="field.name"
        [autofocus]="!!fieldAttributes?.autofocus"
        [maxlength]="fieldAttributes?.maxlength ?? 999"
        [minlength]="fieldAttributes?.minlength ?? 0"
        [placeholder]="field.placeholder || ''"
        [pattern]="fieldAttributes?.pattern ?? ''"
        [readonly]="!!fieldAttributes?.readonly"
      />
      <mat-error *ngIf="form.get(field.name)?.errors" class="me-2">{{
        showError(form.get(field.name)?.errors)
      }}</mat-error>
    </mat-form-field>
  </ng-container>

  <ng-container *ngSwitchCase="'select'">
    <mat-form-field class="w-100" appearance="fill" [hideRequiredMarker]="true">
      <mat-label>{{ field.label }}</mat-label>
      <mat-select
        [formControlName]="field.name"
        [placeholder]="field.placeholder || ''"
        [multiple]="!!fieldAttributes?.multiple"
      >
        <mat-option
          *ngFor="let option of field.options"
          [value]="option.value"
          >{{ option.label }}</mat-option
        >
      </mat-select>
      <mat-spinner
        class="loading"
        [diameter]="30"
        matSuffix
        *ngIf="!!fieldAttributes?.isLoading"
      ></mat-spinner>
      <mat-error *ngIf="form.get(field.name)?.errors" class="me-2">{{
        showError(form.get(field.name)?.errors)
      }}</mat-error>
    </mat-form-field>
  </ng-container>

  <ng-container *ngSwitchCase="'textarea'">
    <mat-form-field class="w-100" appearance="fill" [hideRequiredMarker]="true">
      <mat-label>{{ field.name }}</mat-label>
      <textarea
        matInput
        [formControlName]="field.name"
        [autofocus]="!!fieldAttributes?.autofocus"
        [maxlength]="fieldAttributes?.maxlength ?? 999"
        [minlength]="fieldAttributes?.minlength ?? 0"
        [placeholder]="field.placeholder || ''"
        [pattern]="fieldAttributes?.pattern ?? ''"
        [readonly]="!!fieldAttributes?.readonly"
      ></textarea>
      <mat-error *ngIf="form.get(field.name)?.errors" class="me-2">{{
        showError(form.get(field.name)?.errors)
      }}</mat-error>
    </mat-form-field>
  </ng-container>

  <ng-container *ngSwitchCase="'radio'">
    <div class="w-100">
      <mat-radio-group
        aria-label="Select an option"
        [formControlName]="field.name"
      >
        <mat-label class="d-block">{{ field.label }}</mat-label>
        <mat-radio-button
          [value]="option.value"
          *ngFor="let option of field.options"
          >{{ option.label }}</mat-radio-button
        >
      </mat-radio-group>
    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'date'">
    <div>
      <mat-form-field
        appearance="fill"
        class="w-100"
        [hideRequiredMarker]="true"
      >
        <mat-label>{{ field.placeholder || field.label }}</mat-label>
        <input
          matInput
          [formControlName]="field.name"
          [matDatepicker]="picker"
          [autofocus]="!!fieldAttributes?.autofocus"
          [maxlength]="fieldAttributes?.maxlength ?? 999"
          [minlength]="fieldAttributes?.minlength ?? 0"
          [placeholder]="field.placeholder || ''"
          [pattern]="fieldAttributes?.pattern ?? ''"
          [readonly]="!!fieldAttributes?.readonly"
          [pattern]="fieldAttributes?.pattern || ''"
          [min]="fieldAttributes?.min || undefined"
          [max]="fieldAttributes?.max || undefined"
        />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-error *ngIf="form.get(field.name)?.errors" class="me-2">{{
          showError(form.get(field.name)?.errors)
        }}</mat-error>
      </mat-form-field>
    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'checkbox'">
    <div class="w-100" [formGroupName]="field.name">
      <mat-checkbox
        labelPosition="before"
        *ngFor="let option of field.options"
        [formControlName]="option.label"
        [indeterminate]="!!fieldAttributes?.indeterminate"
      >
        {{ option.label }}
      </mat-checkbox>
    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'autocomplete'">
    <div class="w-100">
      <!-- <mat-form-field appearance="fill">
        <mat-label>{{ field.label }}</mat-label>
        <input
          type="text"
          matInput
          [formControlName]="field.name"
          [placeholder]="field.placeholder ?? ''"
          [autofocus]="!!fieldAttributes?.autofocus"
          [minlength]="fieldAttributes?.minlength ?? 0"
          [maxlength]="fieldAttributes?.maxlength ?? 999"
          [readonly]="!!fieldAttributes?.readonly"
          [pattern]="fieldAttributes?.pattern ?? ''"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete #auto="matAutocomplete">
          <mat-option *ngFor="let option of field.options" [value]="option">
            {{ option.label }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field> -->
      <!-- <mat-label>{{ fieldFormControl | json }}</mat-label> -->
      <!-- <pre>{{ field | json }}</pre> -->
      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>{{ field.label }}</mat-label>
        <input
          type="text"
          placeholder="Pick one"
          aria-label="Number"
          matInput
          [formControlName]="field.name"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          [displayWith]="displayFn.bind(this)"
        >
          <!-- autoCompleteOptions$ -->
          <mat-option
            *ngFor="let option of filteredAutoCompleteOptions$ | async"
            [value]="option"
          >
            {{ option.label }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
  </ng-container>
</div>
